<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Trái tim</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: black;
    }
    canvas {
      display: block;
    }
    #name {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-family: 'Arial', sans-serif;
      font-size: 48px;
      color: red;
      text-shadow: 0 0 15px red, 0 0 40px red;
      opacity: 0;
      transition: opacity 1.5s ease;
      pointer-events: none;
      white-space: nowrap;
      z-index: 10;
    }
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>
  <div id="name">Trần Anh Thư</div>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let w = canvas.width = window.innerWidth;
    let h = canvas.height = window.innerHeight;

    const nameDiv = document.getElementById('name');

    window.addEventListener('resize', () => {
      w = canvas.width = window.innerWidth;
      h = canvas.height = window.innerHeight;
    });

    const stars = Array.from({ length: 50 }, () => ({
      x: Math.random() * w,
      y: Math.random() * h,
      r: Math.random() * 1.5,
      a: Math.random() * 360
    }));

    const energyParticles = [];
    const explosionParticles = [];
    const heart = [];

    function generateHeartPoints(scale = 13, count = 400) {
      const points = [];
      for (let i = 0; i < count; i++) {
        const t = (Math.PI * 2 * i) / count;
        const x = 16 * Math.pow(Math.sin(t), 3);
        const y = -(13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
        points.push({ x: x * scale, y: y * scale });
      }
      return points;
    }

    heart.push(...generateHeartPoints());

    for (let i = 0; i < heart.length; i++) {
      energyParticles.push({
        angle: Math.random() * Math.PI * 2,
        radius: Math.random() * 30 + 20,
        base: heart[i],
        scale: 0.3 + Math.random() * 0.7
      });
    }

    function pointInHeart(x, y, scale = 13) {
      x /= scale;
      y /= scale;
      return Math.pow(x*x + y*y - 1, 3) - x*x*y*y*y < 0;
    }

    const innerHearts = [];
    while (innerHearts.length < 3) {
      const x = (Math.random() - 0.5) * 26 * 13;
      const y = (Math.random() - 0.25) * 26 * 13;
      if (pointInHeart(x, y)) {
        innerHearts.push({
          baseX: x,
          baseY: y,
          scale: 0.5,
          offset: Math.random() * 1000
        });
      }
    }

    let time = 0;
    let exploded = false;
    let showName = false;
    let heartsSpawned = false;
    const smallHearts = [];

    function drawHeartShape(x, y, size, alpha = 1) {
      ctx.save();
      ctx.translate(x, y);
      ctx.scale(size, size);
      ctx.beginPath();
      ctx.moveTo(0, 0);
      ctx.bezierCurveTo(0, -3, -5, -15, -25, -15);
      ctx.bezierCurveTo(-55, -15, -55, 22.5, -55, 22.5);
      ctx.bezierCurveTo(-55, 40, -35, 62, 0, 80);
      ctx.bezierCurveTo(35, 62, 55, 40, 55, 22.5);
      ctx.bezierCurveTo(55, 22.5, 55, -15, 25, -15);
      ctx.bezierCurveTo(10, -15, 0, -3, 0, 0);
      ctx.closePath();
      ctx.fillStyle = `rgba(255,0,80,${alpha})`;
      ctx.fill();
      ctx.restore();
    }

    function animate() {
      ctx.fillStyle = "rgba(0, 0, 0, 0.1)";
      ctx.fillRect(0, 0, w, h);

      // Starfield
      ctx.fillStyle = 'white';
      for (let star of stars) {
        star.a += 0.01;
        const x = star.x + Math.sin(star.a) * 0.5;
        const y = star.y + Math.cos(star.a) * 0.5;
        ctx.beginPath();
        ctx.arc(x, y, star.r, 0, Math.PI * 2);
        ctx.fill();
      }

      ctx.save();
      ctx.translate(w / 2, h / 2);

      // Trái tim nhỏ bên trong trái tim lớn
      if (time < 10000) {
        for (let i = 0; i < innerHearts.length; i++) {
          const hrt = innerHearts[i];
          const offsetX = Math.sin((time + hrt.offset) * 0.005) * 10;
          const offsetY = Math.cos((time + hrt.offset) * 0.005) * 5;
          drawHeartShape(hrt.baseX + offsetX, hrt.baseY + offsetY, hrt.scale, 0.8);
        }
      }

      // Năng lượng dao động
      if (time < 10000) {
        for (let p of energyParticles) {
          const pulse = Math.sin(time * 0.006 + p.base.x * 0.02) * 10;
          const x = p.base.x + Math.cos(p.angle + time * 0.003) * (p.radius + pulse);
          const y = p.base.y + Math.sin(p.angle + time * 0.003) * (p.radius + pulse);
          ctx.fillStyle = 'rgba(255, 0, 100, 0.5)';
          ctx.beginPath();
          ctx.arc(x, y, 2.5 * p.scale, 0, Math.PI * 2);
          ctx.fill();
        }
      } else if (!exploded) {
        for (let p of energyParticles) {
          explosionParticles.push({
            x: p.base.x / 10,
            y: p.base.y / 10,
            vx: (Math.random() - 0.5) * 15,
            vy: (Math.random() - 0.5) * 15,
            life: 0,
            color: `hsla(${Math.random() * 360}, 100%, 70%, 0.8)`
          });
        }
        exploded = true;

        setTimeout(() => {
          nameDiv.style.opacity = 1;
          showName = true;

          setTimeout(() => {
            const rect = nameDiv.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            for (let i = 0; i < 80; i++) {
              smallHearts.push({
                x: centerX,
                y: centerY,
                vx: (Math.random() - 0.5) * 6,
                vy: (Math.random() - 0.5) * 6,
                size: Math.random() * 0.4 + 0.2,
                alpha: 1
              });
            }
            nameDiv.style.opacity = 0;
            heartsSpawned = true;
          }, 3000);
        }, 1000);
      } else {
        for (let i = 0; i < explosionParticles.length; i++) {
          const p = explosionParticles[i];
          p.x += p.vx;
          p.y += p.vy;
          p.life += 1;
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, Math.max(0, 5 - p.life * 0.05), 0, Math.PI * 2);
          ctx.fill();
        }
      }

      ctx.restore();

      // Trái tim nhỏ bay ra từ chữ
      if (heartsSpawned) {
        for (let i = 0; i < smallHearts.length; i++) {
          const hrt = smallHearts[i];
          hrt.x += hrt.vx;
          hrt.y += hrt.vy;
          hrt.alpha -= 0.002;
          drawHeartShape(hrt.x, hrt.y, hrt.size, hrt.alpha);
        }
      }

      time += 16;
      requestAnimationFrame(animate);
    }

    animate();
  </script>
</body>
</html>